#!/usr/bin/env ruby

def sh command
  puts(command)
  exit(1) unless system(command)
end

branch = `git branch | grep '*' | sed 's/* //'`.strip
remote = if ARGV.empty?
           `git remote`.split(/\s+/)
         else
           ARGV
         # if size == 1 then first, otherwise nil
         end.inject{ |r, i| i ? nil : r }

if remote.nil?
  puts("Which remote do you want to track?")
  puts("Usage: git-track [remote]")
  exit(1)
end

sh("git config branch.#{branch}.remote #{remote}")
sh("git config branch.#{branch}.merge refs/heads/#{branch}")
